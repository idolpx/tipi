
{% extends "page_template.html"%}
{% block content %}

<script>
function checkFields(f) {
    if (f.upload_file.value == '') {
       alert("Please select a file from your computer to upload to TIPI");
       f.upload_file.focus();
       
       return false;
    }

    f.uploadFileSubmit.value = ' Uploading, Please Wait ... ';
    f.uploadFileSubmit.disabled = true;
}

function uploadOnClick() {
  document.getElementById('uploadFileButton').style.display='none';
  document.getElementById('uploadForm').style.display='block';
  document.getElementById('selectfiles').focus();
}
</script>


<div class="panel panel-default">

<div class="backup_container">

<h2>Backup</h2>

<p>Create an archive of tipi specific data and configuration.</p>

{% if status == "inprogress" %}
<blockquote>creating archive...</blockquote>
{% endif %}

</div>

<div class="restore_container">

<h2>Restore</h2>

<table cellspacing=4 cellpadding=0 border=0>
  <tr>
    <td valign=center align=left>
      <span id="uploadButtonLabel"><b>Upload Backup File</b></span>
      <div id="uploadForm" style="display:none">
	  <form name="f" action="/uploadBackup" method=post enctype="multipart/form-data" onSubmit="return checkFields(this);">
	      <input type=hidden name="path" value="{{ display_path }}">
	      <input type="file" id="selectfiles" name="upload_file" onClick="f.uploadFileSubmit.value=' Upload ';f.uploadFileSubmit.disabled=false;" multiple=""> 
	      <input name="uploadFileSubmit" id="uploadFileSubmit" type=submit value=" Upload ">
	  </form>
      </div>
      <button id="uploadFileButton" title="uploads files"
	     onClick="uploadOnClick();" class="tool_button">
	  <img src="/images/upload_icon.png" height="30px"/>
      </button>
    </td>
  </tr>
</table>

<p>Restore a backup file, and reboot the system.</p>

<table cellspacing=4 cellpadding=0 border=0>
{% for backup_file in backups %}
  <tr>
    <td valign=center align=left> {{ backup_file.name }} </td>
    <td valign=center> &nbsp; &nbsp; {{ backup_file.date|safe }} </td>
    <td valign=center>
      <a href="{{ backup_file.dl_link }}"><img src="/images/download_icon.png" width=32 title="Download File"/>
      </a>
    </td>
  </tr>
{% endfor %}
</table>

</div>
</div>




{% endblock %}

